{"ast":null,"code":"import { cache } from \"./client\";\nimport { makeVar, gql } from \"@apollo/client\";\nexport const USER = gql`\n  query {\n    user @client\n  }\n`;\nexport const CART = gql`\n  query {\n    cartItems @client\n  }\n`;\nexport const WISHLIST = gql`\n  query {\n    wishlist @client\n  }\n`;\nexport const COMPARE = gql`\n  query {\n    compare @client\n  }\n`;\nexport const CUSTOMER = gql`\n  query {\n    customer @client\n  }\n`; // initialize\n\nexport const init = () => {\n  cache.writeQuery({\n    query: USER,\n    data: {\n      user: false ? JSON.parse(localStorage.getItem(\"user\")) : {\n        id: null,\n        email: null,\n        isAdmin: null,\n        isSeller: null\n      }\n    }\n  });\n  cache.writeQuery({\n    query: CART,\n    data: {\n      cartItems: false ? JSON.parse(localStorage.getItem(\"cartItems\") || '{ \"data\": [] }').data : null\n    }\n  });\n  cache.writeQuery({\n    query: COMPARE,\n    data: {\n      compare: false ? JSON.parse(localStorage.getItem(\"compare\") || '{ \"data\": [] }').data : null\n    }\n  });\n  cache.writeQuery({\n    query: WISHLIST,\n    data: {\n      wishlist: false ? JSON.parse(localStorage.getItem(\"wishlist\") || '{ \"data\": [] }').data : null\n    }\n  });\n  cache.writeQuery({\n    query: CUSTOMER,\n    data: {\n      customer: {\n        phone: null,\n        name: null,\n        address: null\n      }\n    }\n  });\n};\n\nconst modifyUser = ({\n  user\n}) => {\n  if (false) {\n    if (user) {\n      localStorage.setItem(\"user\", JSON.stringify(user));\n    } else {\n      localStorage.removeItem(\"user\");\n    }\n\n    cache.modify({\n      fields: {\n        user() {\n          return user;\n        }\n\n      }\n    });\n  }\n};\n\nconst modifyCart = ({\n  items\n}) => {\n  if (false) {\n    localStorage.setItem(\"cartItems\", JSON.stringify({\n      data: items\n    }));\n    cache.modify({\n      fields: {\n        cartItems() {\n          return items;\n        }\n\n      }\n    });\n  }\n};\n\nconst modifyWishlist = ({\n  items\n}) => {\n  if (false) {\n    localStorage.setItem(\"wishlist\", JSON.stringify({\n      data: items\n    }));\n    cache.modify({\n      fields: {\n        wishlist() {\n          return items;\n        }\n\n      }\n    });\n  }\n};\n\nconst modifyCompare = ({\n  items\n}) => {\n  if (false) {\n    localStorage.setItem(\"compare\", JSON.stringify({\n      data: items\n    }));\n    cache.modify({\n      fields: {\n        compare() {\n          return items;\n        }\n\n      }\n    });\n  }\n};\n\nconst modifyCustomer = ({\n  customer\n}) => {\n  if (false) {\n    if (customer) {\n      localStorage.setItem(\"customer\", JSON.stringify(customer));\n    } else {\n      localStorage.removeItem(\"customer\");\n    }\n\n    cache.modify({\n      fields: {\n        customer() {\n          return customer;\n        }\n\n      }\n    });\n  }\n};\n/* \r\n    you can use client variable below\r\n*/\n\n\nexport const emptyCompare = () => {\n  modifyCompare({\n    items: []\n  });\n};\nexport const removeCompareItem = function (removeItem) {\n  let products = [];\n\n  try {\n    // get\n    products = JSON.parse(localStorage.getItem(\"compare\") || '{ \"data\": [] }').data;\n  } catch {} // change\n\n\n  let items = [];\n  products.map(product => {\n    if (product.id !== removeItem.id) items.push(product);\n  });\n  modifyCompare({\n    items\n  });\n};\nexport function addProductToLocalCompare(newProduct) {\n  // get\n  let products = [];\n\n  try {\n    products = JSON.parse(localStorage.getItem(\"compare\") || '{ \"data\": [] }').data;\n  } catch {} // change\n\n\n  let others = [];\n  products.map(product => {\n    if (product.id !== newProduct.id) {\n      others.push(product);\n    }\n  });\n  const items = [...others, newProduct]; // save\n\n  modifyCompare({\n    items\n  });\n}\nexport const onSignIn = ({\n  user\n}) => {\n  modifyUser({\n    user\n  });\n};\nexport const onSignOut = () => {\n  modifyUser({\n    user: null\n  });\n};\nexport const chooseCustomer = ({\n  customer\n}) => {\n  modifyCustomer({\n    customer\n  });\n};\nexport const emptyCart = function () {\n  modifyCart({\n    items: []\n  });\n};\nexport const removeCartItem = removeItem => {\n  // get\n  const cartItems = JSON.parse(localStorage.getItem(\"cartItems\") || '{ \"data\": [] }').data; // change\n\n  let items = [];\n  cartItems.map(item => {\n    if (item.product.id !== removeItem.product.id) items.push(item);\n  });\n  modifyCart({\n    items\n  });\n};\nexport const changeCartItem = function (cartItem, change) {\n  // get\n  let cartItems = [];\n\n  try {\n    cartItems = JSON.parse(localStorage.getItem(\"cartItems\") || '{ \"data\": [] }').data;\n  } catch {} // change\n\n\n  let items = [];\n  const price = cartItem.product.price - cartItem.product.sale;\n  cartItems.map((item, index) => {\n    const quantity = item.quantity + change > 0 ? item.quantity + change : item.quantity;\n\n    if (item.product.id !== cartItem.product.id) {\n      items.push(item);\n    } else {\n      items.push({\n        product: item.product,\n        quantity,\n        price: price * quantity\n      });\n    }\n  }); // save\n\n  modifyCart({\n    items\n  });\n};\nexport function addProductToLocalCart({\n  product,\n  variables\n}) {\n  // get\n  let cartItems = [];\n\n  try {\n    cartItems = JSON.parse(localStorage.getItem(\"cartItems\") || '{ \"data\": [] }').data;\n  } catch {} // change\n\n\n  let items = [];\n  let exist = false;\n  const price = product.price - product.sale;\n  cartItems.map(cartItem => {\n    if (cartItem.product.id !== product.id) {\n      items.push(cartItem);\n    } else {\n      exist = true;\n      items.push({\n        product: cartItem.product,\n        quantity: cartItem.quantity + 1,\n        price: price * (cartItem.quantity + 1)\n      });\n    }\n  });\n  if (exist === false) items.push({\n    product,\n    quantity: 1,\n    price\n  }); // save\n\n  modifyCart({\n    items\n  });\n}\nexport const emptyWishlist = function () {\n  modifyWishlist({\n    items: []\n  });\n};\nexport const removeWishListItem = function (removeItem) {\n  let products = [];\n\n  try {\n    // get\n    products = JSON.parse(localStorage.getItem(\"wishlist\") || '{ \"data\": [] }').data;\n  } catch {} // change\n\n\n  let items = [];\n  products.map(product => {\n    if (product.id !== removeItem.id) items.push(product);\n  });\n  modifyWishlist({\n    items\n  });\n};\nexport function addProductToLocalWishlist(newProduct) {\n  // get\n  let products = [];\n\n  try {\n    products = JSON.parse(localStorage.getItem(\"wishlist\") || '{ \"data\": [] }').data;\n  } catch {} // change\n\n\n  let others = [];\n  products.map(product => {\n    if (product.id !== newProduct.id) {\n      others.push(product);\n    }\n  });\n  const items = [...others, newProduct]; // save\n\n  modifyWishlist({\n    items\n  });\n}","map":{"version":3,"sources":["D:/Github/ecom-ui/apollo/action.js"],"names":["cache","makeVar","gql","USER","CART","WISHLIST","COMPARE","CUSTOMER","init","writeQuery","query","data","user","JSON","parse","localStorage","getItem","id","email","isAdmin","isSeller","cartItems","compare","wishlist","customer","phone","name","address","modifyUser","setItem","stringify","removeItem","modify","fields","modifyCart","items","modifyWishlist","modifyCompare","modifyCustomer","emptyCompare","removeCompareItem","products","map","product","push","addProductToLocalCompare","newProduct","others","onSignIn","onSignOut","chooseCustomer","emptyCart","removeCartItem","item","changeCartItem","cartItem","change","price","sale","index","quantity","addProductToLocalCart","variables","exist","emptyWishlist","removeWishListItem","addProductToLocalWishlist"],"mappings":"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","sourcesContent":["import { cache } from \"./client\";\r\nimport { makeVar, gql } from \"@apollo/client\";\r\n\r\nexport const USER = gql`\r\n  query {\r\n    user @client\r\n  }\r\n`;\r\nexport const CART = gql`\r\n  query {\r\n    cartItems @client\r\n  }\r\n`;\r\nexport const WISHLIST = gql`\r\n  query {\r\n    wishlist @client\r\n  }\r\n`;\r\nexport const COMPARE = gql`\r\n  query {\r\n    compare @client\r\n  }\r\n`;\r\nexport const CUSTOMER = gql`\r\n  query {\r\n    customer @client\r\n  }\r\n`;\r\n// initialize\r\nexport const init = () => {\r\n \r\n  cache.writeQuery({\r\n    query: USER,\r\n\r\n    data: {\r\n      user:\r\n        typeof window !== \"undefined\"\r\n          ? JSON.parse(localStorage.getItem(\"user\"))\r\n          : { id: null, email: null, isAdmin: null, isSeller: null },\r\n    },\r\n  });\r\n\r\n  cache.writeQuery({\r\n    query: CART,\r\n    data: {\r\n      cartItems:\r\n        typeof window !== \"undefined\"\r\n          ? JSON.parse(localStorage.getItem(\"cartItems\") || '{ \"data\": [] }')\r\n              .data\r\n          : null,\r\n    },\r\n  });\r\n  cache.writeQuery({\r\n    query: COMPARE,\r\n    data: {\r\n      compare:\r\n        typeof window !== \"undefined\"\r\n          ? JSON.parse(localStorage.getItem(\"compare\") || '{ \"data\": [] }').data\r\n          : null,\r\n    },\r\n  });\r\n  cache.writeQuery({\r\n    query: WISHLIST,\r\n    data: {\r\n      wishlist:\r\n        typeof window !== \"undefined\"\r\n          ? JSON.parse(localStorage.getItem(\"wishlist\") || '{ \"data\": [] }')\r\n              .data\r\n          : null,\r\n    },\r\n  });\r\n  cache.writeQuery({\r\n    query: CUSTOMER,\r\n\r\n    data: {\r\n      customer: { phone: null, name: null, address: null },\r\n    },\r\n  });\r\n};\r\nconst modifyUser = ({ user }) => {\r\n  if (typeof window !== \"undefined\") {\r\n    if (user) {\r\n      localStorage.setItem(\"user\", JSON.stringify(user));\r\n    } else {\r\n      localStorage.removeItem(\"user\");\r\n    }\r\n    cache.modify({\r\n      fields: {\r\n        user() {\r\n          return user;\r\n        },\r\n      },\r\n    });\r\n  }\r\n};\r\nconst modifyCart = ({ items }) => {\r\n  if (typeof window !== \"undefined\") {\r\n    localStorage.setItem(\"cartItems\", JSON.stringify({ data: items }));\r\n    cache.modify({\r\n      fields: {\r\n        cartItems() {\r\n          return items;\r\n        },\r\n      },\r\n    });\r\n  }\r\n};\r\nconst modifyWishlist = ({ items }) => {\r\n  if (typeof window !== \"undefined\") {\r\n    localStorage.setItem(\"wishlist\", JSON.stringify({ data: items }));\r\n    cache.modify({\r\n      fields: {\r\n        wishlist() {\r\n          return items;\r\n        },\r\n      },\r\n    });\r\n  }\r\n};\r\nconst modifyCompare = ({ items }) => {\r\n  if (typeof window !== \"undefined\") {\r\n    localStorage.setItem(\"compare\", JSON.stringify({ data: items }));\r\n    cache.modify({\r\n      fields: {\r\n        compare() {\r\n          return items;\r\n        },\r\n      },\r\n    });\r\n  }\r\n};\r\n\r\nconst modifyCustomer = ({ customer }) => {\r\n  if (typeof window !== \"undefined\") {\r\n    if (customer) {\r\n      localStorage.setItem(\"customer\", JSON.stringify(customer));\r\n    } else {\r\n      localStorage.removeItem(\"customer\");\r\n    }\r\n    cache.modify({\r\n      fields: {\r\n        customer() {\r\n          return customer;\r\n        },\r\n      },\r\n    });\r\n  }\r\n};\r\n\r\n/* \r\n    you can use client variable below\r\n*/\r\nexport const emptyCompare = () => {\r\n  modifyCompare({ items: [] });\r\n};\r\nexport const removeCompareItem = function (removeItem) {\r\n  let products = [];\r\n  try {\r\n    // get\r\n    products = JSON.parse(localStorage.getItem(\"compare\") || '{ \"data\": [] }')\r\n      .data;\r\n  } catch {}\r\n\r\n  // change\r\n  let items = [];\r\n  products.map((product) => {\r\n    if (product.id !== removeItem.id) items.push(product);\r\n  });\r\n  modifyCompare({ items });\r\n};\r\nexport function addProductToLocalCompare(newProduct) {\r\n  // get\r\n\r\n  let products = [];\r\n  try {\r\n    products = JSON.parse(localStorage.getItem(\"compare\") || '{ \"data\": [] }')\r\n      .data;\r\n  } catch {}\r\n\r\n  // change\r\n  let others = [];\r\n  products.map((product) => {\r\n    if (product.id !== newProduct.id) {\r\n      others.push(product);\r\n    }\r\n  });\r\n  const items = [...others, newProduct];\r\n\r\n  // save\r\n  modifyCompare({ items });\r\n}\r\n\r\nexport const onSignIn = ({ user }) => {\r\n  modifyUser({ user });\r\n};\r\nexport const onSignOut = () => {\r\n  modifyUser({ user: null });\r\n};\r\n\r\nexport const chooseCustomer = ({ customer }) => {\r\n  modifyCustomer({ customer });\r\n};\r\n\r\nexport const emptyCart = function () {\r\n  modifyCart({ items: [] });\r\n};\r\nexport const removeCartItem = (removeItem) => {\r\n  // get\r\n  const cartItems = JSON.parse(\r\n    localStorage.getItem(\"cartItems\") || '{ \"data\": [] }'\r\n  ).data;\r\n  // change\r\n  let items = [];\r\n  cartItems.map((item) => {\r\n    if (item.product.id !== removeItem.product.id) items.push(item);\r\n  });\r\n  modifyCart({ items });\r\n};\r\nexport const changeCartItem = function (cartItem, change) {\r\n  // get\r\n  let cartItems = [];\r\n  try {\r\n    cartItems = JSON.parse(\r\n      localStorage.getItem(\"cartItems\") || '{ \"data\": [] }'\r\n    ).data;\r\n  } catch {}\r\n\r\n  // change\r\n  let items = [];\r\n  const price = cartItem.product.price - cartItem.product.sale;\r\n\r\n  cartItems.map((item, index) => {\r\n    const quantity =\r\n      item.quantity + change > 0 ? item.quantity + change : item.quantity;\r\n    if (item.product.id !== cartItem.product.id) {\r\n      items.push(item);\r\n    } else {\r\n      items.push({\r\n        product: item.product,\r\n        quantity,\r\n        price: price * quantity,\r\n      });\r\n    }\r\n  });\r\n  // save\r\n  modifyCart({ items });\r\n};\r\n\r\nexport function addProductToLocalCart({ product, variables }) {\r\n  // get\r\n\r\n  let cartItems = [];\r\n  try {\r\n    cartItems = JSON.parse(\r\n      localStorage.getItem(\"cartItems\") || '{ \"data\": [] }'\r\n    ).data;\r\n  } catch {}\r\n\r\n  // change\r\n  let items = [];\r\n  let exist = false;\r\n  const price = product.price - product.sale;\r\n\r\n  cartItems.map((cartItem) => {\r\n    if (cartItem.product.id !== product.id) {\r\n      items.push(cartItem);\r\n    } else {\r\n      exist = true;\r\n      items.push({\r\n        product: cartItem.product,\r\n        quantity: cartItem.quantity + 1,\r\n        price: price * (cartItem.quantity + 1),\r\n      });\r\n    }\r\n  });\r\n  if (exist === false) items.push({ product, quantity: 1, price });\r\n  // save\r\n  modifyCart({ items });\r\n}\r\nexport const emptyWishlist = function () {\r\n  modifyWishlist({ items: [] });\r\n};\r\nexport const removeWishListItem = function (removeItem) {\r\n  let products = [];\r\n  try {\r\n    // get\r\n    products = JSON.parse(localStorage.getItem(\"wishlist\") || '{ \"data\": [] }')\r\n      .data;\r\n  } catch {}\r\n\r\n  // change\r\n  let items = [];\r\n  products.map((product) => {\r\n    if (product.id !== removeItem.id) items.push(product);\r\n  });\r\n  modifyWishlist({ items });\r\n};\r\n\r\nexport function addProductToLocalWishlist(newProduct) {\r\n  // get\r\n\r\n  let products = [];\r\n  try {\r\n    products = JSON.parse(localStorage.getItem(\"wishlist\") || '{ \"data\": [] }')\r\n      .data;\r\n  } catch {}\r\n\r\n  // change\r\n  let others = [];\r\n  products.map((product) => {\r\n    if (product.id !== newProduct.id) {\r\n      others.push(product);\r\n    }\r\n  });\r\n  const items = [...others, newProduct];\r\n\r\n  // save\r\n  modifyWishlist({ items });\r\n}\r\n"]},"metadata":{},"sourceType":"module"}