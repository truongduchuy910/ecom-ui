{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, Fragment } from \"react\";\nimport { useRouter } from \"next/router\";\nimport { gql } from \"@apollo/client\";\nimport { useMutation } from \"@apollo/client\";\nimport { onSignIn, init } from \"../../apollo/action\";\nimport { getErrorMessage } from \"../../lib/chip\";\nimport { useApollo } from \"../../apollo/client\";\nexport const SignInMutation = gql`\n  mutation($email: String!, $password: String!) {\n    authenticateUserWithPassword(email: $email, password: $password) {\n      token\n      item {\n        id\n        email\n        isAdmin\n        isSeller\n      }\n    }\n  }\n`;\nexport function SignIn() {\n  const router = useRouter();\n  const client = useApollo();\n  const [signIn] = useMutation(SignInMutation);\n  const {\n    0: errorMsg,\n    1: setErrorMsg\n  } = useState();\n\n  async function handleSubmit(event) {\n    event.preventDefault();\n    const email = event.currentTarget.elements.email.value;\n    const password = event.currentTarget.elements.password.value;\n\n    try {\n      await client.clearStore();\n      const {\n        data\n      } = await signIn({\n        variables: {\n          email: email,\n          password: password\n        }\n      });\n\n      if (data.authenticateUserWithPassword) {\n        const {\n          authenticateUserWithPassword: {\n            token,\n            item\n          }\n        } = data;\n        localStorage.setItem(\"token\", token);\n        onSignIn({\n          user: item\n        });\n        await router.push({\n          pathname: \"/\"\n        });\n        await client.resetStore();\n        init();\n      }\n    } catch (error) {\n      setErrorMsg(getErrorMessage(error));\n    }\n  }\n\n  return __jsx(Fragment, null, __jsx(\"h2\", null, \"\\u0110\\u0103ng Nh\\u1EADp\"), __jsx(\"form\", {\n    noValidate: true,\n    onSubmit: handleSubmit\n  }, __jsx(\"h5\", null, \"T\\xE0i kho\\u1EA3n\"), __jsx(\"input\", {\n    required: true,\n    id: \"email\",\n    label: \"T\\xE0i kho\\u1EA3n\",\n    name: \"email\",\n    placeholder: \"Nh\\u1EADp T\\xE0i kho\\u1EA3n\",\n    style: {\n      border: \"1px solid black\",\n      padding: 3,\n      paddingLeft: 13\n    }\n  }), __jsx(\"h5\", null, \"M\\u1EADt kh\\u1EA9u\"), __jsx(\"input\", {\n    required: true,\n    name: \"password\",\n    label: \"M\\u1EADt kh\\u1EA9u\",\n    placeholder: \"Nh\\u1EADp M\\u1EADt kh\\u1EA9u\",\n    type: \"password\",\n    id: \"password\",\n    style: {\n      border: \"1px solid black\",\n      padding: 3,\n      paddingLeft: 13\n    }\n  }), __jsx(\"button\", {\n    type: \"submit\",\n    style: {\n      marginTop: 21\n    }\n  }, \"Ti\\u1EBFp T\\u1EE5c\"), errorMsg));\n}","map":null,"metadata":{},"sourceType":"module"}